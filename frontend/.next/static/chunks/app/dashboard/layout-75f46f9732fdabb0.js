(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{285:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var r=n(5155),s=n(4624),a=n(9434);let o=(0,n(2115).forwardRef)((e,t)=>{let{className:n,variant:o="primary",size:l="md",asChild:i=!1,...c}=e,u=i?s.DX:"button";return(0,r.jsx)(u,{className:(0,a.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none cursor-pointer",{"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500":"primary"===o,"bg-secondary-200 text-secondary-900 hover:bg-secondary-300 focus:ring-secondary-500":"secondary"===o,"border border-neutral-300 bg-white text-neutral-700 hover:bg-neutral-50 focus:ring-primary-500":"outline"===o,"text-neutral-700 hover:bg-neutral-100 focus:ring-neutral-500":"ghost"===o},{"px-3 py-2 text-sm":"sm"===l,"px-4 py-2 text-sm":"md"===l,"px-6 py-3 text-base":"lg"===l},n),ref:t,...c})});o.displayName="Button"},3137:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var r=n(5155),s=n(2115),a=n(5695);function o(e){let{className:t=""}=e,[n,o]=(0,s.useState)(!1),l=(0,s.useRef)(null),i=(0,a.useRouter)();(0,s.useEffect)(()=>{let e=e=>{l.current&&!l.current.contains(e.target)&&o(!1)};return n&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n&&o(!1)};return n&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[n]);let c=e=>{o(!1),i.push(e)},u=async()=>{o(!1);try{let e=await fetch("/api/auth/logout",{method:"POST",credentials:"include"});e.ok||console.error("Logout failed:",e.statusText),i.push("/")}catch(e){console.error("Logout error:",e),i.push("/")}};return(0,r.jsxs)("div",{className:"relative ".concat(t),ref:l,children:[(0,r.jsx)("button",{onClick:()=>o(!n),className:"flex items-center justify-center w-8 h-8 rounded-full bg-neutral-100 hover:bg-neutral-200 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-1","aria-label":"Open menu","aria-expanded":n,children:(0,r.jsx)("svg",{className:"w-5 h-5 text-neutral-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),n&&(0,r.jsx)("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white border border-neutral-200 rounded-lg shadow-lg z-[60]",children:(0,r.jsxs)("div",{className:"py-2",children:[[{label:"Upcoming Events",href:"/dashboard/events?view=upcoming",icon:"\uD83D\uDCC5"},{label:"Past Events",href:"/dashboard/events?view=past",icon:"\uD83D\uDCDD"},{label:"Pending Events",href:"/dashboard/pending-events",icon:"⏳"},{label:"Settings",href:"/dashboard/settings",icon:"⚙️"}].map((e,t)=>(0,r.jsxs)("button",{onClick:()=>c(e.href),className:"w-full flex items-center px-4 py-3 text-left text-sm font-body transition-colors text-neutral-700 hover:bg-neutral-50 hover:text-neutral-900 cursor-pointer",children:[(0,r.jsx)("span",{className:"mr-3 text-base",children:e.icon}),(0,r.jsx)("span",{className:"font-medium",children:e.label})]},t)),(0,r.jsx)("div",{className:"my-2 border-t border-neutral-200"}),(0,r.jsxs)("button",{onClick:u,className:"w-full flex items-center px-4 py-3 text-left text-sm font-body text-red-600 hover:bg-red-50 hover:text-red-700 transition-colors cursor-pointer",children:[(0,r.jsx)("span",{className:"mr-3 text-base",children:"\uD83D\uDEAA"}),(0,r.jsx)("span",{className:"font-medium",children:"Sign Out"})]})]})})]})}var l=n(7600),i=n(285),c=n(6766);function u(e){let{children:t}=e,n=(0,a.useRouter)(),{user:s,logout:u,isLoading:d}=(0,l.A)();return(0,r.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,r.jsx)("nav",{className:"fixed top-0 left-0 right-0 bg-white shadow-sm border-b border-secondary-200 z-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{onClick:()=>n.push("/dashboard"),className:"text-xl font-display font-semibold text-neutral-900 transition-colors cursor-pointer",children:"\uD83D\uDCC5 Scheduler"}),(0,r.jsx)("span",{className:"ml-4 text-sm font-body text-neutral-500",children:"Dashboard"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[s&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[s.picture&&(0,r.jsx)(c.default,{src:s.picture,alt:s.name,width:32,height:32,className:"w-8 h-8 rounded-full"}),(0,r.jsxs)("div",{className:"hidden sm:block text-sm",children:[(0,r.jsx)("div",{className:"font-medium text-neutral-900",children:s.name}),(0,r.jsx)("div",{className:"text-neutral-500",children:s.email})]}),(0,r.jsx)(i.$,{onClick:u,variant:"outline",size:"sm",disabled:d,className:"text-neutral-600 hover:text-neutral-900",children:d?"Logging out...":"Logout"})]}),(0,r.jsx)(o,{})]})]})})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto pt-20 pb-6 sm:px-6 lg:px-8",children:t})]})}},3843:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var r=n(9509);let s={NEXT_PUBLIC_APP_NAME:"Coffee Scheduler"},a=(r.env.VERCEL_ENV,{apiUrl:"http://localhost:5001",nodeEnv:"production",appName:r.env.NEXT_PUBLIC_APP_NAME||s.NEXT_PUBLIC_APP_NAME,isDevelopment:!1,isProduction:!0,isTest:!1})},7429:(e,t,n)=>{Promise.resolve().then(n.bind(n,3137))},7600:(e,t,n)=>{"use strict";n.d(t,{A:()=>l,AuthProvider:()=>i});var r=n(5155),s=n(2115),a=n(3843);let o=(0,s.createContext)(void 0),l=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},i=e=>{let{children:t}=e,[n,l]=(0,s.useState)(null),[i,c]=(0,s.useState)(!0),[u,d]=(0,s.useState)(null),[h,m]=(0,s.useState)(0),f=(0,s.useCallback)(async()=>{let e=Date.now();if(e-h<2e3)return void console.log("⏳ Auth check throttled - too soon since last check");m(e);try{console.log("\uD83D\uDD0D Checking auth status..."),c(!0),d(null);let e=await fetch("".concat(a.$.apiUrl,"/api/auth/status"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){var t;let n=await e.json();console.log("✅ Auth status response:",{authenticated:n.authenticated,hasUser:!!n.user,userEmail:null==(t=n.user)?void 0:t.email}),n.authenticated&&n.user?(l(n.user),console.log("\uD83C\uDF89 User authenticated:",n.user.email)):(l(null),console.log("❌ User not authenticated"))}else if(401===e.status)console.log("❌ 401 - Not authenticated"),l(null);else throw Error("Auth check failed: ".concat(e.status))}catch(e){console.error("Auth status check failed:",e),d("Unable to verify authentication status"),l(null)}finally{c(!1)}},[h]),x=async()=>{try{if(d(null),c(!0),(await fetch("".concat(a.$.apiUrl,"/api/auth/logout"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)l(null),window.location.href="/";else throw Error("Logout failed")}catch(e){console.error("Logout failed:",e),d("Logout failed. Please try again.")}finally{c(!1)}};return(0,s.useEffect)(()=>{f();let e=()=>{"undefined"==typeof document||document.hidden||f()},t=()=>{f()};if("undefined"!=typeof document)return document.addEventListener("visibilitychange",e),window.addEventListener("online",t),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("online",t)}},[f]),(0,s.useEffect)(()=>{if(!n)return;let e=setInterval(()=>{f()},3e5);return()=>clearInterval(e)},[n,f]),(0,r.jsx)(o.Provider,{value:{user:n,isAuthenticated:!!n,isLoading:i,error:u,login:()=>{window.location.href="".concat(a.$.apiUrl,"/api/auth/google")},logout:x,checkAuthStatus:f,clearError:()=>{d(null)}},children:t})}},9434:(e,t,n)=>{"use strict";n.d(t,{cn:()=>s});var r=n(2596);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.$)(t)}}},e=>{var t=t=>e(e.s=t);e.O(0,[556,441,684,358],()=>t(7429)),_N_E=e.O()}]);